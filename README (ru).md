# Определение стоимости автомобилей

**Описание задачм:**

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля.
Постройте модель, которая умеет её определять. В вашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.
Критерии, которые важны заказчику:
- качество предсказания;
- время обучения модели;
- время предсказания модели.

**Описание набора данных**

Независимые признаки:
- DateCrawled — дата скачивания анкеты из базы;
- VehicleType — тип автомобильного кузова;
- RegistrationYear — год регистрации автомобиля;
- Gearbox — тип коробки передач;
- Power — мощность (л. с.);
- Model — модель автомобиля;
- Kilometer — пробег (км);
- RegistrationMonth — месяц регистрации автомобиля;
- FuelType — тип топлива;
- Brand — марка автомобиля;
- Repaired — была машина в ремонте или нет;
- DateCreated — дата создания анкеты;
- NumberOfPictures — количество фотографий автомобиля;
- PostalCode — почтовый индекс владельца анкеты (пользователя);
- LastSeen — дата последней активности пользователя.

Целевой признак
- Price — цена (евро)

**Цель работы** — разработать модели машинного обучения, способные предсказывать стоимость автоомобиля, и отобрать из них лучшую на основе метрик качества и скорости обучения.

**Примечания:**
- Для оценки качества моделей будет использована метрика RMSE;
- Значение метрики RMSE должно быть меньше 2500.

**Работа будет проводиться в следующие 7 этапов:**
1. Исследовательский анализ и предобработка данных;
2. Формирование и анализ датасета;
3. Формирование выборок и их препроцессинг;
4. Обучение моделей;
5. Анализ качества и быстродействия моделей;
6. Тестирование лучшей модели
7. Выводы.

# Выводы

Для достижения цели **разработать модели машинного обучения, способные предсказывать стоимость автоомобиля, и отобрать из них лучшую на основе метрик качества и скорости обучения**, была проделана следующая работа:

1. Был проведен исследовательский анализ данных и их предобработка, и были сделаны следующие выводы:
    - В данных присутствуют выбросы, а их распределения ненормальные;
    - В данных присутствует множество аномалий, а именно:
        - Присутствие объявлений о продаже автомобилей за крайне низкие цены, в том числе и за бесплатно (нулевые значения цены);
        - Год регистрации автомобиля имеет сильный разброс: от 1000-ого года до 6000-ого года;
        - Мощность двигателя также имеет ошибки в данных: некоторые автомобили имееют мощность в 0 л.с. или 20000 л.с.;
        - Киллометраж имеет категориальную, а не количественную форму в данных;
        - Количество фотографий представлено единственным значением (0);
        - Год регистрации автомобилей содержит ещё не наступившие года;
    - Были выделены признаки, которые стоит включить в датасет, а также оценено влияние признаков на целевой параметр.
2. С учетом выводом, полученных из исследовательского анализа данных, была проведена предобработка данных, в частности:
    - Удалены из данных аномально низкие значения целевого параметра;
    - Заменены средним годом регистрации аномальные значения года регистрации;
    - Заменены пропусками аномальные значения мозщности двигателя с последующей трансформацией параметра в категориальный признак;
    - Модели и бренды были сгруппированы по ценовым категориям;
    - Редкие категории параметра тип топлива были сгруппированы в одну группу;
    - Почтовые коды были также укрупнены в более общие группы;
3. Был сформирован датасет, а также обучающая и валидационная выборки:
    - Из датасета были удалены все дубликаты;
    - Обучающая и валидационная выборки были сформирвоны в соотношении 75% к 25% соответственно;
    - Количественные фичи были нормализованы с помощью метода MinMax;
    - Категориальные фичи были разбиты на бинарные признаки с помощью OHE;
4. Были разработаны и проанализированны следующие ML-модели:
    1. Linear Regression;
    2. Random Forrest;
    3. MLP;
    4. XGBoost;
    5. LightGBM;
    6. CatBoost.

5. Наиболее подходящей под цель работы была определена модель LightGBM со следующими характеристиками:
    - RMSE - 1832 евро;
    - Скорость обучения - 11 секунд.

6. Наиболее важными параметрами, влияющими на стоимость автомобиля являются:
    1. Год регистрации автомобиля;
    2. Мощность двигателя;
    3. Бренд автомобиля;
    4. Километраж автомобиля;
    5. Тип коробки передач.


7. При тестировании отобранная модель достигает следующих результатов по метрике RMSE в 1814.66 евро

Для последующей работы необходимо определить природу аномалий и исправить ошибки в данных после чего стоит настроить гиперпараметры предложенной модели для повышения её качества.

Таким образом, можно сказать, что цель данной работы достигнута.
